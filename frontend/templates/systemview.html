{% extends "layout.html" %}
{% block title %}Systemview{% endblock %}

{% block content %}
<div style="display: flex; align-items: flex-start;">
    <canvas id="coordinateCanvas" width="1200" height="800"></canvas>
    <div id="infoBox" class="infoBox" style="margin-left: 20px;">
        <h3>Planet Info</h3>
        <p id="planetName">Name: </p>
        <p id="planetCoordinates">Distance from Earth: </p>
        <img id="planetImage" src="" alt="Planet Image" style="width: 100px; height: 100px; display: none;">
    </div>
</div>
<script>
    const exoplanetdata = JSON.parse('{{ data | tojson }}');
    const canvas = document.getElementById('coordinateCanvas');
    const ctx = canvas.getContext('2d');

    const canvasWidth = canvas.width;
    const canvasHeight = canvas.height;

    // Find the min and max x and y values in the data to scale the points
    const minX = Math.min(...exoplanetdata.map(point => point.x));
    const maxX = Math.max(...exoplanetdata.map(point => point.x));
    const minY = Math.min(...exoplanetdata.map(point => point.y));
    const maxY = Math.max(...exoplanetdata.map(point => point.y));

    // Draw points on the canvas
    exoplanetdata.forEach(point => {
        const x = ((point.x - minX) / (maxX - minX)) * canvasWidth;
        const y = ((point.y - minY) / (maxY - minY)) * canvasHeight;
        ctx.fillStyle = 'white';
        ctx.fillRect(x, y, 5, 5);

    });

    // Handle mousemove events
    canvas.addEventListener('mousemove', function (event) {
        const rect = canvas.getBoundingClientRect();
        const x = event.clientX - rect.left;
        const y = event.clientY - rect.top;

        let pointFound = false;
        exoplanetdata.forEach(point => {
            const scaledX = ((point.x - minX) / (maxX - minX)) * canvasWidth;
            const scaledY = ((point.y - minY) / (maxY - minY)) * canvasHeight;
            if (x >= scaledX && x <= scaledX + 10 && y >= scaledY && y <= scaledY + 10) {
                updatePointInfo(point);
                pointFound = true;
            }
        });
    });

    function updatePointInfo(point) {
        document.getElementById('planetName').innerText = `Name: ${point.name}`;
        document.getElementById('planetCoordinates').innerText = `Distance from Earth: ${point.distance}`;
        const planetImage = document.getElementById('planetImage');
        if (point.image) {
            planetImage.src = point.image;
            planetImage.style.display = 'block';
        } else {
            planetImage.style.display = 'none';
        }
    }
</script>
{% endblock %}